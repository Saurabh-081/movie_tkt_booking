{"ast":null,"code":"import axios from 'axios';\nconst API = 'http://localhost:5000';\nexport async function registerRequest(email, password) {\n  try {\n    const res = await axios.post(`${API}/register`, {\n      email,\n      password\n    });\n    return res.data;\n  } catch (error) {\n    if (error.response) {\n      throw error;\n    }\n    throw new Error('Network error or server unreachable');\n  }\n}\nexport async function loginRequest(email, password) {\n  const res = await axios.post(`${API}/login`, {\n    email,\n    password\n  });\n  return res.data;\n}\nexport function saveToken(token) {\n  localStorage.setItem('auth_token', token);\n  try {\n    window.dispatchEvent(new Event('authChanged'));\n  } catch (e) {}\n}\nexport function getToken() {\n  return localStorage.getItem('auth_token');\n}\nexport function decodeToken() {\n  const token = getToken();\n  if (!token) return null;\n  try {\n    const parts = token.split('.');\n    if (parts.length < 2) return null;\n    const payload = parts[1].replace(/-/g, '+').replace(/_/g, '/');\n    const json = decodeURIComponent(atob(payload).split('').map(function (c) {\n      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(''));\n    return JSON.parse(json);\n  } catch (e) {\n    return null;\n  }\n}\nexport function isAuthenticated() {\n  return !!getToken();\n}\nexport function logout() {\n  localStorage.removeItem('auth_token');\n  try {\n    window.dispatchEvent(new Event('authChanged'));\n  } catch (e) {}\n}\n// Attach token to all axios requests\naxios.interceptors.request.use(config => {\n  const token = getToken();\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, err => Promise.reject(err));\nexport async function forgotPasswordRequest(email) {\n  const res = await axios.post(`${API}/forgot`, {\n    email\n  });\n  return res.data;\n}\nexport async function resetPasswordRequest(token, password) {\n  const res = await axios.post(`${API}/reset`, {\n    token,\n    password\n  });\n  return res.data;\n}\nexport function getUserEmail() {\n  const claims = decodeToken();\n  return (claims === null || claims === void 0 ? void 0 : claims.sub) || (claims === null || claims === void 0 ? void 0 : claims.identity) || (claims === null || claims === void 0 ? void 0 : claims.email) || null;\n}","map":{"version":3,"names":["axios","API","registerRequest","email","password","res","post","data","error","response","Error","loginRequest","saveToken","token","localStorage","setItem","window","dispatchEvent","Event","e","getToken","getItem","decodeToken","parts","split","length","payload","replace","json","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse","isAuthenticated","logout","removeItem","interceptors","request","use","config","headers","Authorization","err","Promise","reject","forgotPasswordRequest","resetPasswordRequest","getUserEmail","claims","sub","identity"],"sources":["C:/Users/Saurabh/OneDrive/Desktop/Movie_tkt_booking/frontend-react/src/utils/auth.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API = 'http://localhost:5000';\r\n\r\nexport async function registerRequest(email, password){\r\n  try {\r\n    const res = await axios.post(`${API}/register`, { email, password });\r\n    return res.data;\r\n  } catch (error) {\r\n    if (error.response) {\r\n      throw error;\r\n    }\r\n    throw new Error('Network error or server unreachable');\r\n  }\r\n}\r\n\r\nexport async function loginRequest(email, password){\r\n  const res = await axios.post(`${API}/login`, { email, password });\r\n  return res.data;\r\n}\r\n\r\nexport function saveToken(token){\r\n  localStorage.setItem('auth_token', token);\r\n  try{ window.dispatchEvent(new Event('authChanged')); }catch(e){}\r\n}\r\n\r\nexport function getToken(){\r\n  return localStorage.getItem('auth_token');\r\n}\r\n\r\nexport function decodeToken(){\r\n  const token = getToken();\r\n  if (!token) return null;\r\n  try{\r\n    const parts = token.split('.');\r\n    if (parts.length < 2) return null;\r\n    const payload = parts[1].replace(/-/g, '+').replace(/_/g, '/');\r\n    const json = decodeURIComponent(atob(payload).split('').map(function(c) {\r\n      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n    }).join(''));\r\n    return JSON.parse(json);\r\n  }catch(e){\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function isAuthenticated(){\r\n  return !!getToken();\r\n}\r\n\r\nexport function logout(){\r\n  localStorage.removeItem('auth_token');\r\n  try{ window.dispatchEvent(new Event('authChanged')); }catch(e){}\r\n}\r\n// Attach token to all axios requests\r\naxios.interceptors.request.use(config => {\r\n  const token = getToken();\r\n  if (token){\r\n    config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n}, err => Promise.reject(err));\r\n\r\nexport async function forgotPasswordRequest(email){\r\n  const res = await axios.post(`${API}/forgot`, { email });\r\n  return res.data;\r\n}\r\n\r\nexport async function resetPasswordRequest(token, password){\r\n  const res = await axios.post(`${API}/reset`, { token, password });\r\n  return res.data;\r\n}\r\n\r\nexport function getUserEmail(){\r\n  const claims = decodeToken();\r\n  return claims?.sub || claims?.identity || claims?.email || null;\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}